\documentclass[12pt,a4paper]{article}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{graphicx}
\usepackage{amsmath,amssymb,amsfonts}
\pagestyle{plain}


\topmargin=0mm
%\footskip=6mm
\headheight=0pt \headsep=0pt

\oddsidemargin 0.5cm

\evensidemargin 0.5cm

\textwidth 17.0cm

\textheight 25cm

\topmargin -0.5cm


%%%%%%%%%%%%%%%%Определение переменных названий интерфейса программы

\newcommand{\NameOfListDistanceFunction}{Выберите функцию
расстояния}
\newcommand{\DistanceSelectedByUser}{Задано
пользователем}
\newcommand{\UserClusterizationFunction}{Функция кластеризации $d(x,y)=$}
\newcommand{\ClusterizationFunctionEuclid}{Евклидово расстояние}
\newcommand{\ClusterizationFunctionCityBlock}{City-block расстоняние}
\newcommand{\ClusterizationFunctionMahalanobis}{Расстояние Махаланобиса}
\newcommand{\ClusterizationFunctionHamming}{Расстояние Хэмминга}
\newcommand{\ClusterizationFunctionJaccard}{1-Jaccard coef.}
\newcommand{\ClusterizationFunctionCosine}{1-Cosine coef.}
\newcommand{\ClusterizationFunctionChebychev}{Расстояние Чебышева}
\newcommand{\ClusterizationFunctionCityMinkovskii}{Расстояние Минковского}
\newcommand{\LinkageMinimum}{Минимальное расстояние}
\newcommand{\LinkageMaximum}{Максимальное расстояние}
\newcommand{\LinkageEuclid}{Евклидово расстояние между центроидами}
\newcommand{\LinkageAverage}{Среднее классовое расстояние}



%%%%%%%%%%%%%%Конец комманд, определяющих интерфейс ECOMAP%%%%%

\begin{document}
\section{Краткая документация к программе ECOMAP}

Программа ECOMAP предназначена для графического изображения карт
кластеров сходных факторных отношений, географически привязанных к
определенному участку местности. ECOMAP представляет собой алгоритм
кластеризации, реализованный на языке программирования высокого
уровня MatLab, снабженный пользовательским интерфейсом, позволяющим
проводить гибкую настройку процесса кластеризации с учетом
особенностей решаемых задач.

\textbf{Принцип работы программы.}

На основе данных обучающей выборки, для всевозможных пар факторов,
рассчитываются матрицы взаимной встречаемости. Если размерность
факторного пространства $m$, то количество вычисляемых матриц
встречаемости равно $m(m-1)/2$. Размерность каждой из матриц
определяется количеством градаций соответствующих ей пары факторов.
Элементами матриц являются частоты (эмпирические оценки условных
вероятностей) взаимной встречаемости факторов, найденные по
обучающей выборке.

Далее, каждой картируемой точке $x$ с учетом вычисленного по
обучающей выборке массива матриц взаимной встречаемости
сопоставляется матрица $S_{m\times m}(x)$. Элементами этой матрицы
являются значения функции сопряженности $f(a,b,c)$, вычисленные на
значениях элементов матриц взаимной встречаемости. Поясним это
следующим примером.

Пусть рассматривается трехфакторное пространство с факторами
$\Phi_1,\Phi_2,\Phi_3$, каждый из которых имеет соответственно
$s_1,s_2$ и $s_3$ градаций. Таким образом, общее число матриц
встречаемости, вычисленное по некоторой обучающей выборке, будет
равно $3\cdot2/2=3$. Обозначим эти матрицы для определенности
$M(\Phi_1,\Phi_2)$, $M(\Phi_2,\Phi_3)$ и $M(\Phi_1,\Phi_3)$, т.е.
$M(\Phi_i,\Phi_j)$ матрица взаимной встречаемости градаций факторов
$\Phi_i$ и $\Phi_j$ размерностью $\dim M(\Phi_i,\Phi_j)=s_i\times
s_j$.

Если картируемой точке $x$ соответствует набор градаций факторов
$(\Phi_1(x),\Phi_2(x),\Phi_3(x))$, то соответствующая матрица
$S_{3\times 3}(x)$ будет определяться следующим образом:
$$
S_{3 \times 3}(x)  = \begin{array}{*{20}c}
   {} & {\Phi _1 } & {\Phi _2 } & {\Phi _3 }  \\
   {\Phi _1 } &  0  & {a_1 (x)} & {a_2 (x)}  \\
   {\Phi _2 } & {a_1 (x)} &  0  & {a_3 (x)}  \\
   {\Phi _3 } & {a_2 (x)} & {a_3 (x)} &  0   \\
\end{array}, \,\,\mbox{т.е.}\,\, S_{3 \times 3}(x)=\left(
\begin{array}{ccc}
     0  & {a_1 (x)} & {a_2 (x)}  \\
    {a_1 (x)} &  0  & {a_3 (x)}  \\
    {a_2 (x)} & {a_3 (x)} &  0
\end{array}
\right).
$$
Значение $a_1(x)$ для пары факторов $\Phi_1$ и $\Phi_2$, вычисляется
по элементам матрицы встречаемости $M(\Phi_1,\Phi_2)$. Если
$i_{1,2}$ и $j_{1,2}$ --- номер строки и номер столбца матрицы
$M(\Phi_1,\Phi_2)$ соответствующие градациям $\Phi_1(x)$ и
$\Phi_2(x)$, то
$$
\begin{array}{l} a_1(x)=f(a,b,c),\,\,\mbox{где}\\
a=\sum\limits_{k = 1}^{s_2 } {M_{i_{1,2} k} (\Phi _1 ,\Phi _2 )},\\
b=\sum\limits_{k = 1}^{s_1 } {M_{kj_{1,2} } (\Phi _1 ,\Phi _2 )},\\
c=M_{i_{1,2} j_{1,2}} (\Phi _1 ,\Phi _2 ).
\end{array}
$$
Аналогичным образом определяются значения $a_2(x)$ и $a_3(x)$.

Функция сопряженности $f(a,b,c)$ задается пользователем (по
умолчанию в программе используется мера Жаккара, т.е.
$f(a,b,c)=c/(a+b-c)$). В данной реализации программы используются
только симметричные меры сопряженности, поэтому матрицы $S(x)$
являются симметричными по построению. Диагональные элементы матрицы
$S(x)$ не участвуют в работе программы и полагаются равными 0.

Таким образом, каждой картируемой точке сопоставляется матрица
сопряженности. Кластеризация массива матриц сопряженности,
вычисленных для множества точек некоторой местности --- есть
алгоритмическая суть программы ECOMAP.

\textbf{Алгоритм кластеризации}.

В данном разделе описан алгоритм кластеризации матриц факторных
отношений, реализованный в программе ECOMAP.

\begin{enumerate}

\item Верхнетреугольный блок (без главной диагонали) матриц факторных отношений $S(x)$
вытягивается в вектор размерности $m(m-1)/2$, где $m$ ---
размерность факторного пространства. Данная операция реализуется для
каждой матрицы факторных отношений; их общее число определяется
количеством картируемых точек ($N$). В результате формируется
матрица размерности $m(m-1)/2\times N$, столбцы которой являются
векторами, подлежащими кластеризации.

\item Для всевозможных пар полученных векторов вычисляется матрица
взаимных расстояний в соответствии с выбранной (или непосредственно
определенной) пользователем функцией расстояния между векторами $x$
и $y$: $d(x,y)$. В программе реализовано 8 вариантов  функций
$d(x,y)$; по умолчанию используется евклидово расстояние, т.е.
$d(x,y)=((x-y)^T(x-y))^{1/2}$. При необходимости пользователь может
самостоятельно задать вид функции расстояния $d(x,y)$,
предварительно выбрав во вкладке "\NameOfListDistanceFunction"\,
опцию "\DistanceSelectedByUser". Размерность матрицы взаимных
расстояний (равна $N(N-1)/2$) определяется количеством $(N)$
картируемых точек.

\item В соответствии с определенным пользователем критерием
кластеризации формируется иерархическое дерево, число листов
которого равно $N$.

\item По заданному пользователем количеству кластеров ($P$)
(по умолчанию в программе $P=3$) проводится кластеризация векторов:
каждому вектору назначается номер кластера, которому он принадлежит.
Процедура кластеризации представляется собой последовательное
перемещение от корня иерархического дерева, до момента выделения $P$
или более кластеров.

\end{enumerate}

\textbf{Функция расстояния $d(x,y)$.}

Пользователь может самостоятельно определить функцию расстояния
$d(x,y)$ или воспользоваться 8 вариантами ее реализации в программе.
Следует иметь ввиду, что при самостоятельном определении функции
$d(x,y)$ время вычисления матрицы взаимных расстояний, а
следовательно и время всего процесса кластеризации, существенно
возрастет. Учитывая, что размерность этой матрицы велика и
определяется количеством картируемых точек, рекомендуется
использовать предусмотренные в программе варианты функций
расстояния.

При пользовательском определении функции расстояния следует
записывать только тело функции, писать $d(x,y)=$ не следует. При
этом полагается, что переменные $x$ и $y$ являются векторами и
операции с ними записываются как операции над векторами. Например,
если мы хотим определить пользовательскую функцию расстояния
$d(x,y)=\sqrt{\sum\limits_i(x_i-y_i)^2}$, т.е. евклидово расстояние
между векторами (на практике такой необходимости не возникнет,
поскольку евклидово расстояние является штатной функцией расстояния
программы ECOMAP), то в поле "\UserClusterizationFunction"\,
необходимо записать:
$$
\begin{array}{l}
\textsf{sqrt}((x-y)'*(x-y)),\,\,\mbox{или}\\
((x-y)'*(x-y))^{\wedge} 0.5,\,\,\mbox{или}\\
((x-y)'*(x-y))^{\wedge} (1/2),\\
\end{array}
$$
где $\textsf{sqrt}$ --- операция извлечения квадратного корня,
"$'$"\,
--- символ транспонирования вектора (в соответствии с синтаксисом языка
MatLab), "*"\, --- операция умножения матриц (в данном случае
вектор-строка умножается на вектор-столбец), "$^{\wedge}$"\, ---
операция возведения в степень.

В программе ECOMAP предусмотрены следующие штатные функции $d(x,y)$:

\begin{enumerate}
\item \ClusterizationFunctionEuclid:
$d(x,y)=\sqrt{\sum\limits_i(x_i-y_i)^{2^{\phantom{Q}}}}$.

\item \ClusterizationFunctionCityBlock:  $d(x,y)=\sum\limits_i|x_i-y_i|$.

\item \ClusterizationFunctionCityMinkovskii:
$d(x,y)=\left(\sum\limits_i(x_i-y_i)^p\right)^{1/p}$. Параметр $p$
определяется пользователем по запросу в процессе работы программы.
Следует иметь ввиду, что при $p=2$ и $p=1$ расстояние Минковского
отождествляется соответственно с евклидовым и City-block
расстояниями.

\item \ClusterizationFunctionMahalanobis:
$d(x,y)=(x-y)^TV^{-1}(x-y)$, где $V$ --- выборочная оценка
ковариационной матрицы.

\item \ClusterizationFunctionHamming: $d(x,y)$ --- отношение
количества неравных друг другу компонент векторов $x$ и $y$ к
размерности вектора $x$ (или $y$).

\item \ClusterizationFunctionJaccard: $d(x,y)$ --- отношение
количества неравных нулю и друг другу компонент векторов $x$,$y$ к
общему числу ненулевых компонент в обоих векторах $x$ и $y$.

\item \ClusterizationFunctionCosine: $d(x,y)=1-\cos(\angle x,y)$, где
$\cos(\angle x,y)=\dfrac{x^Ty}{\sqrt{(x^Tx)(y^Ty)}}$.

\item \ClusterizationFunctionChebychev: $d(x,y)=\mathop {\max }\limits_i |x_i  - y_i
|$.
\end{enumerate}

\textbf{Критерий кластеризации.}

При построении иерархического дерева используется функция расстояния
между кластерами, определенная на элементах матрицы всевозможных
парных расстояний. Пользователь может выбрать четыре способа
вычисления расстояния\footnote{Не путать с расстоянием между
векторами, определяемым функцией $d(x,y)$.} между кластерами
(критерия кластеризации), каждому способу будет соответствовать свой
исход процесса кластеризации.

Для пояснения методов вычисления расстояния между кластерами введем
обозначения:
\begin{itemize}
\item $X_{ri}$, $Y_{sj}$ --- \textit{i}-ый и \textit{j}-ый вектора,
принадлежащие кластерам $r$ и $s$ соответственно.

\item $n_r$, $n_s$ --- количество векторов в кластере $r$ и $s$.

\item  $D(r,s)$ --- расстояние между кластерами $r$ и $s$.
\end{itemize}


В зависимости от выбора пользователя расстояние $D(r,s)$
определяется следующим образом:
\begin{enumerate}
\item \LinkageMinimum: $D(r,s)=\mathop {\min }\limits_{i,j} d(X_{ri} ,X_{sj} ),\,i=1\ldots n_r,\,j=1\ldots
n_s$.

\item \LinkageMaximum:  $D(r,s)=\mathop {\max }\limits_{i,j} d(X_{ri} ,X_{sj} ),\,i=1\ldots n_r,\,j=1\ldots
n_s$.

\item \LinkageEuclid:
$D(r,s)=((\overline{X}_r-\overline{X}_s)^T(\overline{X}_r-\overline{X}_s))^{1/2}$,
где $\overline{X}_r=\dfrac{1}{n_r}\sum\limits_iX_{ri}$ и
$\overline{X}_s=\dfrac{1}{n_s}\sum\limits_jX_{sj}$.

\item \LinkageAverage: $D(r,s)=\dfrac{1}{n_r
n_s}\sum\limits_{i,j}d(X_{ri},X_{sj})$.

\end{enumerate}

После того, как  критерий кластеризации  выбран (определено
расстояние $D(r,s)$), осуществляется процесс построения
иерархического бинарного дерева, которое хранится в памяти ЭВМ в
виде матрицы $Z_{N-1\times3}$ ($N$ --- количество классифицируемых
объектов). Формирование матрицы происходит по следующему
принципу\footnote{Принцип изложен в документации к инструментарию
Statistics Toolbox для среды MatLab}:

\begin{enumerate}
\item Все классифицируемые вектора нумеруются от 1 до $N$.

\item Первая строка матрицы $Z$ соответствует двум тривиальным кластерам,
содержащим по одному объекту, расстояние между которыми в
определенном выше смысле минимально. Элементы $Z_{11}$ и $Z_{12}$
--- номера объединенных объектов.

\item  Каждый новый сформированный кластер,
соответствующий \textit{q}-ой строке матрицы $Z$, приобретает индекс
$N+q$. Два кластера $r$ и $s$ объединяются вместе, если расстояние
$D(r,s)$ между ними минимально. Элементы $Z_{q1}$ и $Z_{q2}$
--- номера объединенных вместе кластеров, $Z_{q3}$ --- расстояние
<<\textit{D}>> между объединенными кластерами.

\end{enumerate}

Для иллюстрации процесса построения бинарного иерархического дерева
и представления его посредством матрицы $Z$  рассмотрим пример.

Необходимо построить бинарное иерархическое дерево для столбцов
матрицы $R$, используя в качестве расстояния между векторами
--- "\ClusterizationFunctionEuclid", а в качестве расстояния между кластерами
--- "\LinkageMinimum".
$$
R = \left[ {\begin{matrix}
   1 & 2 & 1 & 3 & 7 & 8 & 2  \cr
   2 & 4 & {32} & 6 & 6 & 3 & 1  \cr
  \end{matrix}} \right]
$$

Матрица $Z$ будет иметь вид
$$
Z=\left[\begin{matrix} 1&   7 &  1.414\cr 2&   8&   2.236\cr 4& 9&
2.236\cr 5& 6& 3.162\cr 10&  11&  4\cr 3&   12& 26.076\cr
\end{matrix}\right].
$$
Первый кластер получается в результате объединения столбцов <<1>> и
<<7>> (первая строка матрицы $Z$), расстояние между которыми
минимально и равно 1.414. Далее, полученный первый кластер
приобретает номер 8=7+1, и вычисление взаимных расстояний
производится уже с учетом этого кластера. Оказывается, что
расстояние между сформированным кластером и вторым столбцом
минимально и равно 2.236, поэтому второй столбец объединяется с
первым кластером (вторая строка матрицы $Z$). Полученная ветвь
дерева (второй сформированный кластер), состоящая уже из трех
листьев, получает номер 9=7+2. На следующем шаге группируются
столбец <<4>> и кластер <<9>> (формируется третий кластер),
полученная группа приобретает номер 10=7+3 (третья строка матрицы
$Z$). Далее объединяются столбцы <<5>> и  <<6>> (расстояние 3.162),
полученный кластер приобретает номер 11=7+4. Следующее минимальное
расстояние между оставшимися структурами <<10>>, <<11>> и столбцом
<<3>> наблюдается у пары <<10>>, <<11>> (расстояние 4). Группируя
их, присваиваем полученному кластеру номер 12=7+5. Завершающим шагом
является группировка кластера <<12>> и столбца <<3>>.
\begin{figure}[h]
\centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=8cm]{fig1}\\
  \caption{Бинарное иерархическое дерево (дендрограмма).}\label{fig1}
\end{figure}

Графическое изображение сформированного бинарного дерева
представлено на рис.~\ref{fig1}. По оси абсцисс отложены номера
столбцов матрицы $R$, по оси ординат
--- расстояние (третий столбец матрицы $Z$) между последовательно
группируемыми кластерами.

Заключительный этап алгоритма кластеризации --- разбиение объектов
по группам может быть представлен как последовательный спуск по
дендрограмме (рис.~\ref{fig1}) до тех пор, пока <<горизонтальное>>
ее сечение не приведет к образованию требуемого (или большего) числа
кластеров. Пусть в рассмотренном примере необходимо было
сформировать 3 кластера. Тогда сечение на <<высоте>> равной 4
дендрограммы приводит к появлению трех кластеров: \{1, 2, 4,
7\},\{5, 6\},\{3\}.

После того, как описанный процесс кластеризации выполнен для всего
множества картируемых точек, строится карта кластеров,
представляющая собой области в которых парные отношения факторов в
чем-либо схожи.

\section{Тестовый пример работы программы ECOMAP}

Построим карту кластеров сходных факторных отношений для территории
учебно-опытного лесхоза "Дальневосточный". Имеющийся массив данных
--- 1885 описаний (распределенных регулярно с шагом 500 м по всей
территории лехоза) с географической привязкой к системе координат
WGS-84. Рассмотрим ситуацию, когда картируемая территория, и
территория, которой соответствует обучающая выборка, совпадают. При
построении карты кластеров будем учитывать только факторы
геоморфологической группы
--- высоту над уровнем моря (13 градаций), экспозицию склона (11
градаций) и крутизну склона (7 градаций).

Примем следующие сокращенные обозначения факторов: $\Phi _1$="Высота
над уровнем моря", $\Phi _2$="Экспозиция склона", $\Phi
_3$="Крутизна склона".

Факторы имеют следующие градации (целочисленный номер градации
соответствует номеру столбца или строки матрицы взаимных
встречаемостей): фактор $\Phi_1$: 1 --- 0--100 м,   2 --- 101--150
м, 3 --- 151--200 м, 4 --- 201--250 м, 5 --- 251--300 м, 6 ---
301--350 м, 7 --- 351--400 м, 8 --- 401--450 м, 9 --- 451--500 м, 10
--- 501--550 м, 11 --- 551--600 м, 12 --- 601--650 м, 13 ---
651--700 м; фактор $\Phi_2$: 1 --- равнина,   2 --- пойма, 3 ---
север, 4 --- северо-восток, 5 --- восток, 6 --- юго-восток, 7 ---
юг, 8 --- юго-запад, 9 --- запад, 10 --- северо-запад, 11 ---
водороздел; фактор $\Phi_3$: 1 --- менее $1^{\circ}$, 2 --- от
$1^{\circ}$ до $6^{\circ}$, 3 --- от $6^{\circ}$ до $10^{\circ}$, 4
--- от $10^{\circ}$ до $15^{\circ}$, 5 --- от $15^{\circ}$ до
$20^{\circ}$, 6 --- от $20^{\circ}$ до $25^{\circ}$, 7 --- более
$25^{\circ}$.

Найденные по обучающей выборке матрицы взаимной встречаемости
градаций факторов имеют вид:

{
$$
M(\Phi_1,\Phi_2)=\left[ \begin {array}{ccccccccccc}
10&16&0&3&0&0&6&4&0&0&0\\\noalign{\medskip}10&44&36&13&10&14&23&19&13&22&1\\\noalign{\medskip}20&38&60&28&14&24&40&32&21&28&0\\\noalign{\medskip}14&34&49&49&19&29&36&45&22&35&0\\\noalign{\medskip}7&19&71&41&19&25&51&34&25&41&0\\\noalign{\medskip}13&8&56&38&22&17&54&47&27&31&0\\\noalign{\medskip}2&12&21&23&15&14&31&23&22&30&8\\\noalign{\medskip}0&6&16&7&9&7&8&13&9&13&9\\\noalign{\medskip}0&2&6&5&0&2&4&1&6&8&10\\\noalign{\medskip}0&0&1&0&0&0&2&0&2&4&0\\\noalign{\medskip}0&0&0&0&0&0&1&0&0&1&0\\\noalign{\medskip}0&0&1&0&0&0&0&1&1&1&0\\\noalign{\medskip}0&0&0&1&0&0&0&0&0&0&0\end
{array} \right]
$$

$$
M(\Phi_2,\Phi_3)=\left[ \begin {array}{ccccccc}
21&55&0&0&0&0&0\\\noalign{\medskip}9&90&42&29&6&3&0\\\noalign{\medskip}0&108&112&69&22&3&3\\\noalign{\medskip}0&74&73&55&6&0&0\\\noalign{\medskip}0&42&45&20&1&0&0\\\noalign{\medskip}0&56&39&30&6&1&0\\\noalign{\medskip}0&72&87&63&26&7&1\\\noalign{\medskip}1&74&82&47&11&3&1\\\noalign{\medskip}0&76&42&27&2&1&0\\\noalign{\medskip}0&97&65&42&9&1&0\\\noalign{\medskip}8&20&0&0&0&0&0\end
{array} \right]
$$

$$
M(\Phi_1,\Phi_3)=\left[ \begin {array}{ccccccc}
8&26&3&1&1&0&0\\\noalign{\medskip}5&131&45&15&7&2&0\\\noalign{\medskip}5&153&84&47&12&3&1\\\noalign{\medskip}6&117&126&64&12&5&2\\\noalign{\medskip}0&81&132&96&22&2&0\\\noalign{\medskip}5&88&99&96&18&5&2\\\noalign{\medskip}6&91&52&43&7&2&0\\\noalign{\medskip}2&43&35&14&3&0&0\\\noalign{\medskip}2&31&5&3&3&0&0\\\noalign{\medskip}0&2&3&2&2&0&0\\\noalign{\medskip}0&0&1&0&1&0&0\\\noalign{\medskip}0&0&2&1&1&0&0\\\noalign{\medskip}0&1&0&0&0&0&0\end
{array} \right]
$$
}


Приведем в виде матрицы ($F$) фрагмент (первые 10 записей)
используемого массива описаний\footnote{При учете всех 1885 описаний
данная матрица будет иметь 1885 строк.}. Каждая строка матрицы $F$
соответствует отдельному описанию и содержит градации факторов
$\Phi_1$, $\Phi_2$ и $\Phi_3$ (нижний индекс соответствует номеру
столбца $F$).
$$
F=\left[ \begin {array}{ccc}
3&7&3\\\noalign{\medskip}3&10&2\\\noalign{\medskip}2&8&2\\\noalign{\medskip}3&2&2\\\noalign{\medskip}3&4&2\\\noalign{\medskip}2&3&2\\\noalign{\medskip}2&2&3\\\noalign{\medskip}3&8&3\\\noalign{\medskip}4&4&3\\\noalign{\medskip}3&4&2\end
{array} \right]
$$
Для построения карты кластеров используем следующие дополнительные
условия эксперимента: мера сопряженности факторов --- коэффициент
Жаккара, функция расстояния между векторами $x$ и $y$: d(x,y) ---
"\ClusterizationFunctionCityBlock", межклассовое расстояние
--- "\LinkageMaximum", количество кластеров равно 4.
Соответствующая матрице $F$ матрица парных сопряженностей факторов
($Q$) будет иметь вид:
$$
Q=\left[ \begin {array}{cccccccccc} {\frac {40}{521}}&{\frac
{28}{491}}&{\frac {19}{405}}&{\frac {19}{223}}&{\frac
{28}{485}}&{\frac {2}{27}}&{\frac {11}{85}}&{\frac {8}{123}}&{\frac
{49}{491}}&{\frac {28}{485}}\\\noalign{\medskip}{\frac
{21}{202}}&{\frac {153}{916}}&{\frac {131}{838}}&{\frac
{153}{916}}&{\frac {153}{916}}&{\frac {131}{838}}&{\frac
{5}{83}}&{\frac {21}{202}}&{\frac {126}{793}}&{\frac
{153}{916}}\\\noalign{\medskip}{\frac {29}{252}}&{\frac
{97}{881}}&{\frac {74}{909}}&{\frac {90}{853}}&{\frac
{37}{449}}&{\frac {108}{973}}&{\frac {21}{362}}&{\frac
{41}{362}}&{\frac {73}{722}}&{\frac {37}{449}}\end {array} \right]
$$


Первая строка матрицы $Q$ содержит коэффициенты  Жаккара для
факторов $\Phi_1$ и $\Phi_2$, вторая строка --- для факторов
$\Phi_1$ и $\Phi_3$, третья строка --- для факторов $\Phi_2$ и
$\Phi_3$. Столбцы матрицы $Q$ соответствуют описаниям,
представленным строками матрицы $F$. Например, в пятой строке
матрицы $F$ определены градации $(\Phi_1,\Phi_2,\Phi_3)=(3,4,2)$.
Тогда, соответственно, в пятом столбце матрицы $Q$ будет
$\frac{28}{485}$ --- коэффициент Жаккара для пары градаций
$(\Phi_1,\Phi_2)=(3,4)$, $\frac{153}{916}$ --- коэффициент Жаккара
для пары градаций $(\Phi_1,\Phi_3)=(3,2)$, $\frac{37}{449}$ ---
коэффициент Жаккара для пары градаций $(\Phi_2,\Phi_3)=(4,2)$.


В соответствии с выбранными насройками процедуры кластеризации
столбцам матрицы $Q$ будут присвоены номера кластеров
$$\left[
\begin {array}{cccccccccc} 2&2&1&2&2&2&4&2&2&2\end {array}
\right].$$


Для картируемой области, представленной 1885 точками, построены
следующие карты кластеров (рис.~\ref{fig2}, рис.~\ref{fig3}: долгота
--- ось абсцисс (градусы), широта --- ось ординат (градусы)).

Сглаживание (на рис.~\ref{fig3}) выполнено методом k-ближайших
соседей при  k=40. Интерфейс программы ECOMAP позволяет изменять
параметр сглаживания, обеспечивая подбор ситуации с наилучшим
визуальным разбиением области на кластеры.

\begin{figure}[h]
% Requires \usepackage{graphicx}
\centering
  \includegraphics[width=14cm]{fig2}\\
  \caption{Карта кластеров схожих факторных отношений (без сглаживания).}
  \label{fig2}
\end{figure}
\begin{figure}[h]
\centering
% Requires \usepackage{graphicx}
  \includegraphics[width=14cm]{fig3}\\
  \caption{Карта кластеров схожих факторных  отношений (сглаживание k=40).}
   \label{fig3}
\end{figure}


В заключение рассмотрим рис.~\ref{fig4} на котором представлены
кластеры территории учебно-опытного лесхоза "Дальневосточный"\,
построенные при следующих условиях: учтенные факторы --- доминант и
содоминант древостоя, доминант подроста, высота над уровнем моря и
экспозиция склона; мера сопряженности факторов --- коэффициент
Жаккара, функция расстояния между векторами $x$ и $y$: d(x,y) ---
"\ClusterizationFunctionChebychev", межклассовое расстояние
--- "\LinkageMaximum", количество кластеров равно 4. Сглаживание
границ кластеров проводилось методом k-ближайших соседей при
$k=110$.
\begin{figure}[h]
\centering
% Requires \usepackage{graphicx}
  \includegraphics[width=14cm]{fig4}\\
  \caption{Карта кластеров схожих факторных  отношений (сглаживание k=110).}
   \label{fig4}
\end{figure}
\clearpage На рис.~\ref{fig4} четко выделяются кластеры, которые на
местности соответствуют областям преобладания той или иной породы.
Например, в восточной части территории, характеризующейся
преимущественно горными массивами, преобладают хвойные породы
деревьев. В северо-западной части лесхоза --- четко выделяется
область, занимаемая лесами с преобладанием дуба.




\end{document}
